<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <script src="../js/games_lib/ludiAdapter.js" charset="utf-8"></script>

  <title>CR7 Euro Penalty Flick</title>
  
  <script type='text/javascript'>
		!function(a){var b=/iPhone/i,c=/iPod/i,d=/iPad/i,e=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,f=/Android/i,g=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,h=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,i=/Windows Phone/i,j=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,k=/BlackBerry/i,l=/BB10/i,m=/Opera Mini/i,n=/(CriOS|Chrome)(?=.*\bMobile\b)/i,o=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,p=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),q=function(a,b){return a.test(b)},r=function(a){var r=a||navigator.userAgent,s=r.split("[FBAN");if("undefined"!=typeof s[1]&&(r=s[0]),s=r.split("Twitter"),"undefined"!=typeof s[1]&&(r=s[0]),this.apple={phone:q(b,r),ipod:q(c,r),tablet:!q(b,r)&&q(d,r),device:q(b,r)||q(c,r)||q(d,r)},this.amazon={phone:q(g,r),tablet:!q(g,r)&&q(h,r),device:q(g,r)||q(h,r)},this.android={phone:q(g,r)||q(e,r),tablet:!q(g,r)&&!q(e,r)&&(q(h,r)||q(f,r)),device:q(g,r)||q(h,r)||q(e,r)||q(f,r)},this.windows={phone:q(i,r),tablet:q(j,r),device:q(i,r)||q(j,r)},this.other={blackberry:q(k,r),blackberry10:q(l,r),opera:q(m,r),firefox:q(o,r),chrome:q(n,r),device:q(k,r)||q(l,r)||q(m,r)||q(o,r)||q(n,r)},this.seven_inch=q(p,r),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this},s=function(){var a=new r;return a.Class=r,a};"undefined"!=typeof module&&module.exports&&"undefined"==typeof window?module.exports=r:"undefined"!=typeof module&&module.exports&&"undefined"!=typeof window?module.exports=s():"function"==typeof define&&define.amd?define("isMobile",[],a.isMobile=s()):a.isMobile=s()}(this);

		var global_is_mobile = isMobile.any;

		/*
		// b10af
		var target_w = 320;
		var target_h = 480;
		*/
		// johnny bravo
		//var target_w = 320;
		//var target_h = 480;
		// b10ua
		var target_w = 768;
		var target_h = 1280;
		
		var maxRatio = 0.6;
		var minRatio = 0.44;
		// at
		// b10ov
		//var target_w = 640;
		//var target_h = 360;

		var landscape = 90;
		var portrait = 0;
		var target_orientation;
		if ( target_w > target_h )
		{
			target_orientation = landscape;
		} else
		{
			target_orientation = portrait;
		}
  </script>

  <!--http://www.html5rocks.com/en/mobile/mobifying/-->
  <meta name="viewport"
        content="width=device-width,user-scalable=no,initial-scale=1, minimum-scale=1,maximum-scale=1"/>

  <!--https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html-->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="format-detection" content="telephone=no">

  <!-- force webkit on 360 -->
  <meta name="renderer" content="webkit"/>
  <meta name="force-rendering" content="webkit"/>
  <!-- force edge on IE -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <meta name="msapplication-tap-highlight" content="no">

  <!-- force full screen on some browser -->
  <meta name="full-screen" content="yes"/>
  <meta name="x5-fullscreen" content="true"/>
  <meta name="360-fullscreen" content="true"/>
  
  <!-- force screen orientation on some browser -->
  <meta name="screen-orientation" content="portrait"/>
  <meta name="x5-orientation" content="portrait">

  <!--fix fireball/issues/3568 -->
  <!--<meta name="browsermode" content="application">-->
  <meta name="x5-page-mode" content="app">

  <!--<link rel="apple-touch-icon" href=".png" />-->
  <!--<link rel="apple-touch-icon-precomposed" href=".png" />-->

  <link rel="stylesheet" type="text/css" href="style.css"/>

  <style>
		* {
			-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
		}
		
		html {
			overflow: hidden;
		}
		
		body, html {
			margin: 0;
			padding: 0;
			background-color: #202020;
			-webkit-touch-callout: none;
			-webkit-user-select: none;
			-khtml-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
			user-select: none;
			/*text-align: center;*/
			/* IOS FIX */
			overflow: hidden;
			height: 100%;
			touch-action:manipulation;
			position: fixed;
			width: 100%;
			
		}
		
		html { font-size: 100%; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; overflow: hidden !important; position:relative; height: 100%; }

		body { margin: 0; font-size: 13px; line-height: 1.231;  -ms-content-zooming: none; -ms-touch-action: none; }
		#GameCanvas {
			margin: 0;
			padding: 0;
			z-index: 1;
			width  : 100%;
			height  : 100%;
			/* IOS FIX */
			display:block;
			position:absolute;
			top:0; 
			left: 0; 
			z-index: 1;
		}
		.vmid_outer {
			display: table;
			position: absolute;
			width: 100%;
			height: 100%;
		}
		.vmid_middle {
			display: table-cell;
			vertical-align: middle;
		}
		.vmid_inner {
			width:  640px;
			height: 360;
			margin: auto;
			position: absolute;
			top: 0;
			bottom: 0;
			left: 0;
			right: 0;
		}
		.body:-webkit-full-screen {
			width: 100%;
			height:100%;
		}
	</style>

</head>
<body>

<div id="outer" class="vmid_outer">
	<div id="middle" class="vmid_middle" style="background-image: url('loading.gif'); background-repeat:no-repeat; background-size: 20vw auto; background-position: center;" >
		<div class="vmid_inner" id="size_regulator">
  <canvas id="GameCanvas" oncontextmenu="event.preventDefault()" tabindex="0"></canvas>
		</div>
	</div>
</div>

  
  
<!-- Polyfills bundle. -->
<script src="src/polyfills.bundle.js" charset="utf-8"> </script>

<!-- SystemJS support. -->
<script src="src/system.bundle.js" charset="utf-8"> </script>

<!-- Import map -->
<script src="src/import-map.json" type="systemjs-importmap" charset="utf-8"> </script>

<script>
    System.import('./index.js').catch(function(err) { console.error(err); })
	var screen_orientation = -1;
	var game_canvas_width = 0;
	var resize_handler = function() {
		//var ww = window.screen.width;
		//var wh = window.screen.height;
		var ww = window.innerWidth
				 || document.documentElement.clientWidth
				 || document.body.clientWidth;

		var wh = window.innerHeight
				 || document.documentElement.clientHeight
				 || document.body.clientHeight; 
		screen_orientation = ( ww > wh ) ? landscape : portrait;
		var w = ww;
		var h = wh;
		var d = document.getElementById( 'size_regulator' );
		if ( !global_is_mobile || screen_orientation == target_orientation )
		{
			var w_ar = ww / wh;
			if ( w_ar > maxRatio )
			{
				h = wh;
				w = h * maxRatio;
			} 
			else if ( w_ar < minRatio )
			{
				h = wh;
				w = h * minRatio;
			} 
			else
			{
				w = ww;
				h = w / (ww/wh);
			}
		}
		d.style.width = ""+w+"px";
		d.style.height = ""+h+"px";
		game_canvas_width = w;
		//console.log( "resize: " + screen_orientation + " " + w + "x" + h );
	};
	resize_handler();

	resize_timeout = function()
	{
		window.setTimeout( function(){ resize_handler(); window.setTimeout( resize_timeout, 16 ); }, 16 );
	}
	resize_timeout();
	var body = document.getElementsByTagName('body')[0];
	body.onResize = resize_handler;
	window.addEventListener( "resize", resize_handler );
	window.addEventListener( "touchstart", resize_handler );
	window.addEventListener( "orientationchange", resize_handler );
	window.addEventListener( "deviceorientation", resize_handler );
	window.addEventListener( "devicemotion", resize_handler );
	document.addEventListener( "resize", resize_handler );
	document.addEventListener( "touchstart", resize_handler );
	document.addEventListener( "deviceorientation", resize_handler );
	body.onOrientationChange = resize_handler;

	var outer = document.getElementById('outer');
	var middle = document.getElementById('size_regulator');

	outer.ontouchmove = function(e) {e.preventDefault()};
	middle.ontouchmove = function(e) {e.preventDefault()};

	window.addEventListener('gesturestart', e => e.preventDefault(), false);
	window.addEventListener('gesturechange', e => e.preventDefault(), false);
	window.addEventListener('gestureend', e => e.preventDefault(), false);
	
	
	window.trackEvent = function ( data )
	{
		if ( data.event === "onMainMenu" )
		{
			dataLayer.push(
			{
				'event' : 'ga_event',
				'ga_category' : 'Gamepage',
				'ga_action' : 'Main Menu',
				'ga_label': 'CR7 Euro Penalty Flick',
				'ga_noninteraction' : true
			});
		}
		else if ( data.event === "onPause" )
		{
			
		}
		else if ( data.event === "onResume" )
		{
			
		}
		else if ( data.event === "onLevelStart" )
		{
			dataLayer.push({
		    		'event': 'ga_event',
					'ga_category' : 'Gamepage',
					'ga_action' : 'Start',
					'ga_label': 'CR7 Euro Penalty Flick',
					'ga_noninteraction' : false
		    	}); 
		}
		else if ( data.event === "onLevelEnd" )
		{
			playAds();
			dataLayer.push({
				'event': 'ga_event',
				'ga_category' : 'Gamepage',
				'ga_action' : 'Completion',
				'ga_label': 'CR7 Euro Penalty Flick',
				'ga_noninteraction' : false
			});
		}
	};
</script>
<script type="text/javascript" src="scriptLite.js"></script>
<script type="text/javascript">
	launchScript( true, false, true);
</script>

</body>
</html>
